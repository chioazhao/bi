(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-318e4324"],{"3ae1":function(e,t,a){"use strict";a("cf54")},"41a8":function(e,t,a){"use strict";a("ec28")},"961a":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t("div",{ref:"board",staticClass:"anylysis-center"},[t("div",{staticClass:"switch-container"},[t("el-button-group",[t("el-button",{attrs:{type:"brand"===a.data.dataType?"primary":"info",size:"small"},on:{click:function(e){a.data.dataType="brand"}}},[e._v("品牌")]),t("el-button",{attrs:{type:"shop_name"===a.data.dataType?"primary":"info",size:"small"},on:{click:function(e){a.data.dataType="shop_name"}}},[e._v("店铺")])],1)],1),t("div",{staticClass:"search-container"},[t(a.SearchForm,{ref:"searchForm",on:{"on-search":a.getData,"on-export":a.exportData}})],1),t("div",{staticClass:"table-container"},[t(a.Table,{ref:"treeTable",attrs:{loading:a.data.loading,columns:a.data.listCols,data:a.data.tableData,setColumn:!0,option:a.data.tableOption,"row-key":"index","tree-props":{children:"child_list"}},on:{"change-tree":a.expandAll}})],1)])},n=[],r=a("c7eb"),i=a("1da1"),s=a("5530"),l=(a("d81d"),a("4e82"),a("99af"),a("c1fb")),c=a("da71"),p=function(){return l["a"].get(c["a"].api("Dashboard/BrandFinance/getShopOptions"))},d=function(e){var t=e.shopId,a=e.brand,o=e.dataType,n=e.timeFrame,r=e.startDate,i=e.endDate,s=e.sort,p={shopId:t,brand:a,dataType:o,timeFrame:n,startDate:r,endDate:i,sort:s};return l["a"].get(c["a"].api("Dashboard/BrandFinance/getShopFinanceReportList"),{params:p})},u=function(e){var t=c["a"].api("Dashboard/BrandFinance/exportShopFinance")+"?";for(var a in e)t+="".concat(a,"=").concat(e[a],"&");window.open(t)},h=a("2b0e"),f=a("fa7d"),m={checked:!0,fixed:!1,sortable:!1,headerAlign:"center",showOverflowTooltip:!0,minWidth:100,align:"right",toString:!1,toolTip:"",subTooltip:"",class:"",subClass:"",subProp:"",trend:"",icon:"el-icon-question",process:function(e){return isNaN(e)?e:Object(f["h"])(e)},subProcess:function(e){return(isNaN(e)?e+"%":Object(f["h"])(e))+"%"},disabled:!1},b=[{prop:"title",title:"店铺品牌",tooltip:"一键展开/折叠",align:"left",minWidth:180,disabled:!0,fixed:!0,openAll:!0},{fixed:!0,prop:"sale_amount",title:"销售额",tooltip:"反馈成功金额",minWidth:120,sortable:!0,disabled:!0},{prop:"profit",subProp:"profit_pro",title:"利润 | 利润率",tooltip:"销售额-费用-商品成本）/销售额",minWidth:150,sortable:!0,class:"text-cyan",subClass:"text-orange"},{prop:"rebate_amount",title:"返利",tooltip:""},{prop:"cost_amount",title:"商品成本",tooltip:""},{prop:"gross_profit",subProp:"gross_profit_pro",title:"毛利 | 毛利率",tooltip:"（销售额-商品成本）/销售额",minWidth:150,class:"text-cyan",subClass:"text-orange",sortable:"custom"},{prop:"all_expenses",subProp:"all_expenses_pro",title:"费用 | 费用率",tooltip:"除了商品成本外的其他费用 / 销售额",minWidth:150,class:"text-cyan",subClass:"text-orange"},{prop:"plat_commissions",subProp:"plat_commissions_pro",title:"平台_佣金 | 占比",minWidth:150,subClass:"text-orange"},{prop:"plat_marketing_expenses",subProp:"plat_marketing_expenses_pro",title:"平台_营销费用 | 占比",minWidth:180,subClass:"text-orange"},{prop:"plat_other_expenses",subProp:"plat_other_expenses_pro",title:"平台_其他 | 占比",minWidth:150,subClass:"text-orange"},{prop:"marketing_expenses",subProp:"marketing_expenses_pro",title:"线下打款_营销费用 | 占比",minWidth:210,subClass:"text-orange"},{prop:"post_expenses",subProp:"post_expenses_pro",title:"配发费 | 占比",minWidth:150,subClass:"text-orange"},{prop:"return_expenses",subProp:"return_expenses_pro",title:"退货费用 | 占比",minWidth:150,subClass:"text-orange"},{prop:"other_expenses",subProp:"other_expenses_pro",title:"其他费用 | 占比",minWidth:150,subClass:"text-orange"},{prop:"labor_cost_expenses",subProp:"labor_cost_expenses_pro",title:"人工成本 | 占比",minWidth:150,subClass:"text-orange"},{prop:"manage_expenses",subProp:"manage_expenses_pro",title:"管理费用 | 占比",minWidth:150,subClass:"text-orange"},{prop:"interest_expenses",subProp:"interest_expenses_pro",title:"资金成本 | 占比",minWidth:150,subClass:"text-orange"},{prop:"shop_people_nums",title:"店铺人数",minWidth:110}],_=function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t("div",{staticClass:"search-form"},[t("el-form",{ref:"form",attrs:{model:a.data.form,size:"small",inline:""}},[t("el-form-item",{attrs:{label:"店铺："}},[t("el-select",{staticStyle:{width:"250px"},attrs:{clearable:"",multiple:"",filterable:"","collapse-tags":"",placeholder:"请选择店铺，可搜索，可多选"},on:{change:a.handleOptionChange},model:{value:a.data.form.shops,callback:function(t){e.$set(a.data.form,"shops",t)},expression:"data.form.shops"}},e._l(a.data.shopOptions,(function(e){return t("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1),t("el-button-group",[t("el-button",{attrs:{type:"warning"},on:{click:a.onClearGroupSelect}},[e._v("清空")]),t("el-button",{attrs:{type:"primary"},on:{click:a.onSelectAllGroup}},[e._v("全选")])],1)],1),t("el-form-item",{attrs:{label:"品牌："}},[t("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"请输入品牌",clearable:""},model:{value:a.data.form.brand,callback:function(t){e.$set(a.data.form,"brand",t)},expression:"data.form.brand"}})],1),t("el-form-item",{attrs:{label:"时间："}},[t("el-date-picker",{attrs:{type:"day"==a.data.form.timeFrame?"daterange":"monthrange","range-separator":"-","value-format":(a.data.form.timeFrame,"yyyy-MM-dd"),format:"day"==a.data.form.timeFrame?"yyyy年MM月dd日":"yyyy年MM月","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":a.data.pickerOptions},model:{value:a.data.form.date,callback:function(t){e.$set(a.data.form,"date",t)},expression:"data.form.date"}})],1),t("el-form-item",[t("el-button-group",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:a.onSearch}},[e._v("查询")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:a.onExport}},[e._v("导出")])],1)],1)],1)],1)},x=[],v=(a("4de4"),a("d3b7"),a("b0c0"),a("fb6a"),a("a15b"),a("159b"),a("14d9"),a("a434"),a("ed08")),g=a("d0f1"),y={__name:"search-form",setup:function(e,t){var a=t.expose,o=t.emit,n=Object(h["reactive"])({shopOptions:[],pickerOptions:{shortcuts:g["a"]},form:{shops:[],brand:"",timeFrame:"day",date:[]}});Object(h["onMounted"])((function(){b(),l(),Object(h["nextTick"])((function(){d()}))}));var l=function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){var t;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p();case 2:t=e.sent,n.shopOptions=t.data.filter((function(e){return 1==e.type})).map((function(e){return{label:e.name,value:e.id}}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c=function(){var e,t=Object.assign({},Object(s["a"])({},n.form));return t.date?["startDate","endDate"].map((function(e,a){t[e]="month"===t.timeFrame?t["date"][a].slice(0,7):t["date"][a]})):(t["startDate"]="",t["endDate"]=""),t["shopId"]=null===(e=n.form.shops)||void 0===e?void 0:e.join(","),t},d=function(){o("on-search",c())},u=function(){o("on-export",c())},f=function(){n.form.shops=[]},m=function(){var e=[];n.shopOptions.forEach((function(t){e.push(t.value)})),n.form.shops=e},b=function(){n.form.timeFrame="day";var e=Object(v["a"])(new Date,"yyyy-MM-dd");n.form.date=[e,e]},_=function(e){1!==e.length&&(-2===e[0]?n.form.shops=[-2]:-2===e[e.length-1]&&n.form.shops.splice(e.indexOf(-2),1))};return a({_getFormData:c}),{__sfc:!0,searchEmit:o,data:n,getData:l,_getFormData:c,onSearch:d,onExport:u,onClearGroupSelect:f,onSelectAllGroup:m,setDefaultDate:b,handleOptionChange:_}}},C=y,k=(a("b1c1"),a("2877")),w=Object(k["a"])(C,_,x,!1,null,"e2590e98",null),O=w.exports,D=a("dc19"),S={__name:"index",setup:function(e){var t=b.map((function(e){return Object(s["a"])(Object(s["a"])({},m),e)})),a=Object(h["ref"])("treeTable"),o=Object(h["ref"])("searchForm"),n=Object(h["reactive"])({dataType:"brand",loading:!1,tableData:[],listCols:t,tableOption:{ref:"brandBoard",key:"brandBoard",backendSummary:!0,defaultSort:{prop:"sale_amount",order:"descending"},tips:"点击行首 > 展开列表"},total:0,expand:!1});Object(h["watch"])((function(){return n.dataType}),(function(){c()}));var l=function(){n.expand=!n.expand,n.tableData.map((function(e){return e.children=n.expand?e.child_list:void 0})),a.value.toggleRowExpansion()},c=function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){var t,a,i;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=o.value._getFormData(),n.loading=!0,a=Object(s["a"])(Object(s["a"])({},t),{},{dataType:n.dataType}),e.next=5,d(a);case 5:i=e.sent,n.tableData=i.data,n.loading=!1;case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(e){u(Object(s["a"])(Object(s["a"])({},e),{},{dataType:n.dataType}))};return{__sfc:!0,cols:t,treeTable:a,searchForm:o,data:n,expandAll:l,getData:c,exportData:p,listCols:b,SearchForm:O,Table:D["a"]}}},j=S,T=(a("e742"),Object(k["a"])(j,o,n,!1,null,"37d40e57",null));t["default"]=T.exports},a6a0:function(e,t,a){},b1c1:function(e,t,a){"use strict";a("a6a0")},cf54:function(e,t,a){},dc19:function(e,t,a){"use strict";a("e9c4"),a("c7cd");var o=function(){var e=this,t=this,a=t._self._c;return a("div",{staticClass:"wrapper"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.setColumn,expression:"setColumn"}],staticClass:"header"},[a("div",{staticClass:"tips"},[a("i",{staticClass:"el-icon-info"}),t._v(" "+t._s(t.option.tips))]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.setColumn,expression:"setColumn"}],staticClass:"setting"},[t.option.edit?a("div",[t.option.edit.able?a("el-button",{staticClass:"btn-able",attrs:{size:"small"},on:{click:t.handleClickEditBtn}},[t._v("编辑")]):a("el-button",{staticClass:"btn-disable",attrs:{size:"small",disabled:""}},[t._v("编辑")])],1):t._e(),t.option.unfilterable?t._e():a("div",{staticClass:"setting-icon"},[a("el-popover",{attrs:{placement:"left",trigger:"click","popper-class":"settingPopper"}},[a("el-checkbox-group",{staticClass:"check-container",on:{change:t.handleChangeSelectColumn},model:{value:t.selectCol,callback:function(e){t.selectCol=e},expression:"selectCol"}},t._l(t.col,(function(e){return a("el-checkbox",{key:e.prop,staticClass:"check-item",attrs:{label:e.prop,disabled:e.disabled},model:{value:e.checked,callback:function(a){t.$set(e,"checked",a)},expression:"item.checked"}},[t._v(" "+t._s(e.title)+" ")])})),1),a("div",{staticClass:"select-group"},[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.selectAll}},[t._v("全选")]),a("el-button",{attrs:{type:"info",plain:"",size:"mini"},on:{click:t.emptyAll}},[t._v("清空")])],1),a("div",{staticClass:"filter-container",attrs:{slot:"reference"},slot:"reference"},[a("i",{staticClass:"icon el-icon-s-tools"}),t._v(" 筛选 ")])],1)],1)])]),a("el-table",t._g(t._b({directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],key:JSON.stringify(t.checkedCol),ref:t.option.ref,class:t.option.backendSummary?"backend-summary table1":"table1",attrs:{"highlight-current-row":"",tableKey:t.option.key,data:t.tableData,"element-loading-text":"数据加载中","element-loading-spinner":"el-icon-loading","tooltip-effect":"light","show-summary":t.option.showSummary,size:"mini",height:"100%","cell-style":t.option.cellStyle,"header-cell-style":t.option.headerCellStyle,"summary-method":function(a){return e.option.summaryMethod(a,t.checkedCol)},"default-sort":t.option.defaultSort,"cell-class-name":function(e){return t.cellClassName(e)},border:"",lazy:""},on:{"row-click":t.handleRowClick}},"el-table",t.$attrs,!1),t.$listeners),[t.option.selectable?a("el-table-column",{attrs:{type:"selection",width:"55"}}):t._e(),t._l(t.checkedCol,(function(e,o){return a("el-table-column",{key:e.prop,attrs:{"column-key":e.prop+":"+e.cellClass,index:o,label:e.label,align:e.align,"min-width":e.minWidth,fixed:e.fixed,prop:e.prop,"header-align":e.headerAlign,sortable:!!e.sortable&&("custom"!==e.sortable||"custom"),"show-overflow-tooltip":!e.notShowOverflowTooltip,type:e.type},scopedSlots:t._u([{key:"default",fn:function(o){return[t._t(e.slotName,null,null,o),a("span",{class:e.class},[t._v(" "+t._s(e.process(o.row[e.prop]))+" ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:e.subProp,expression:"item.subProp"}]},[a("el-divider",{attrs:{direction:"vertical"}}),a("span",{class:e.subClass},[t._v(" "+t._s(e.subProcess(o.row[e.subProp]))+" ")])],1),e.trend&&e.trendProcess()?a("span",[o.row[e.trend]?a("span",{class:[o.row[e.trend]>0?"up":"down"]},[a("i",{class:[o.row[e.trend]>=0?"el-icon-top":"el-icon-bottom"]}),t._v(" "+t._s(e.trendProcess(Math.abs(o.row[e.trend])))+" ")]):a("span",[a("el-divider",{attrs:{direction:"vertical"}}),t._v("-")],1)]):t._e()]}}],null,!0)},[a("template",{slot:"header"},[a("el-tooltip",{attrs:{content:e.tooltip,placement:"top",effect:"light"}},[a("template",{slot:"content"},[a("span",{staticStyle:{display:"flex","justify-content":"center"}},[t._v(t._s(e.tooltip))]),e.tooltip2&&e.tooltip3?a("div",{staticStyle:{"margin-top":"5px"}},[a("span",[t._v(t._s(e.tooltip2))]),a("br"),a("span",[t._v(t._s(e.tooltip3))])]):t._e()]),e.openAll?a("span",{staticClass:"cursor-pointer",on:{click:t.openOrCloseAll}},[t._v(" "+t._s(e.title)),e.icon?a("i",{class:e.icon}):t._e()]):a("span",[t._v(" "+t._s(e.title)),e.icon?a("i",{class:e.icon}):t._e()])],2)],1)],2)}))],2)],1)},n=[],r=a("5530"),i=a("2909"),s=(a("d81d"),a("d3b7"),a("159b"),a("a434"),a("14d9"),a("4de4"),a("caad"),a("2532"),a("4e82"),a("fb6a"),a("a15b"),a("aa47")),l=a("ac0d"),c={name:"CTable",mixins:[l["d"],l["a"]],props:{option:Object,columns:{type:Array,default:function(){return[]}},data:{type:Array,default:function(){return[]}},setColumn:{type:Boolean,default:!1},loading:Boolean,visible:Boolean},watch:{columns:{handler:function(e){var t=this.getStorageCol(),a=[];a=t?this.dataDiff(e,t):Object(i["a"])(e),this.col=a.map((function(e,t){return Object(r["a"])(Object(r["a"])({},e),{},{index:t})})),this.checkedCol=this.checkedColFun(this.col),this.selectCol=this.checkedCol.map((function(e){return e.prop}))},immediate:!0},data:{handler:function(e){this.tableData=Object(i["a"])(e)},immediate:!0},col:{handler:function(e){this.setStorageCol(e)},deep:!0,immediate:!0},tableData:{handler:function(){var e=this;this.$nextTick((function(){e.$refs[e.option.ref].doLayout()}))},immediate:!0}},data:function(){return{expandedRows:[],tableData:[],col:[],checkedCol:[],selectCol:[],expands:[]}},mounted:function(){var e=this;document.body.ondrop=function(e){e.preventDefault(),e.stopPropagation()},this.$nextTick((function(){e.columnDrop()}))},methods:{openOrCloseAll:function(){this.$emit("change-tree")},expandRows:function(e){var t=this,a=e.data,o=e.expand;a.forEach((function(e){var a;t.$refs[t.option.ref].toggleRowExpansion(e,o);var n=t.expandedRows.indexOf(e);n>-1?null===(a=t.expandedRows)||void 0===a||a.splice(n,1):t.expandedRows.push(e)}))},handleRowClick:function(e,t,a){this.$emit("on-clear-row-selection",{ref:this.$refs[this.option.ref]}),this.$refs[this.option.ref].toggleRowSelection(e)},getRowKeys:function(e){return e.id},expandSelect:function(e,t){this.expands=[],t.length>0&&this.expands.push(e.id)},handleClickEditBtn:function(){this.$emit("on-open-edit-form")},handleClickDelBtn:function(){this.$emit("on-open-del-form")},cellClassName:function(e){if(("shopSaleList"!=this.option.ref||0!==e.rowIndex)&&e.column.columnKey)return e.column.columnKey.split(":")[1]?e.column.columnKey.split(":")[1]:void 0},drop:function(){var e=this;this.$nextTick((function(){e.columnDrop(),e.$refs[e.option.ref].doLayout()}))},selectAll:function(){this.selectCol=this.col.map((function(e){return e.prop})),this.col.filter((function(e){return!e.disabled})).forEach((function(e){return e.checked=!0})),this.checkedCol=this.checkedColFun(this.col),this.drop()},emptyAll:function(){this.selectCol=this.col.filter((function(e){return e.disabled})).map((function(e){return e.prop})),this.col.filter((function(e){return!e.disabled})).forEach((function(e){return e.checked=!1})),this.checkedCol=this.checkedColFun(this.col),this.drop()},handleChangeSelectColumn:function(){var e=this;this.col.forEach((function(t){t.checked=e.selectCol.includes(t.prop)})),this.checkedCol=this.checkedColFun(this.col),this.drop()},rowDrop:function(){var e=this,t=document.querySelector(".el-table__body-wrapper tbody");s["a"].create(t,{onEnd:function(t){var a=t.newIndex,o=t.oldIndex,n=[e.tableData[o],e.tableData[a]];e.tableData[a]=n[0],e.tableData[o]=n[1],e.drop(),e.$emit("dropRow",{dropRow:e.tableData[o],targetRow:e.tableData[a],dropRowIndex:o,targetRowIndex:a,data:e.tableData})}})},columnDrop:function(){var e=this;if(this.option.notAllowDrop)return!1;var t=this.$refs[this.option.ref].$el.querySelector(".el-table__header-wrapper tr");s["a"].create(t,{animation:180,delay:0,onEnd:function(t){var a=t.newIndex,o=t.oldIndex,n=e.checkedCol[o],r=e.checkedCol[a],i=[n.index,r.index];e.col[r.index].index=i[0],e.col[n.index].index=i[1],e.col.sort((function(e,t){return e.index-t.index})),e.checkedCol=e.checkedColFun(e.col),e.tableData=e.tableData.slice(0,e.tableData.length),e.drop(),e.$emit("dropCol",{colItem:n,newIndex:a,oldIndex:o,column:e.checkedCol})}})},checkedColFun:function(e){return e.filter((function(e){return e.checked}))},setStorageCol:function(e){this.option.key&&e&&e.length>0&&localStorage.setItem("CTable-"+this.option.key,JSON.stringify(e))},getStorageCol:function(){var e=localStorage.getItem("CTable-"+this.option.key);return e?JSON.parse(e):""},dataDiff:function(e,t){var a=e.length,o=t.length;if(a!=o)return e;var n=e.map((function(e){return e.prop})).sort(),i=t.map((function(e){return e.prop})).sort();if(n.join()!=i.join())return e;for(var s=[],l=0;l<t.length;l++)for(var c=t[l],p=0;p<e.length;p++){var d=e[p];c.prop===d.prop&&s.push(Object(r["a"])(Object(r["a"])({},d),{},{index:c.index,checked:c.checked}))}return s}}},p=c,d=(a("3ae1"),a("41a8"),a("2877")),u=Object(d["a"])(p,o,n,!1,null,null,null);t["a"]=u.exports},dd13:function(e,t,a){},e742:function(e,t,a){"use strict";a("dd13")},ec28:function(e,t,a){}}]);